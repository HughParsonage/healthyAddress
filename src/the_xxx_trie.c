#include "healthyAddress.h"

#define N_THE_XXXS 702

// This is true, but not necessarily the longest
// word one might find in an address string
#define MAX_STREET_NAME_LEN 41

// US[, .N, keyby = .(STREET_NAME)][order(-N)]
// There was one street (with a mere 9 addresses Australia-wide) that contained
// anything other than A-Z or ' ', viz THE YACHTSMAN'S DRIVE
// At this time (2023-12-31) unsure how to deal with these things
const char * THE_XXXs[N_THE_XXXS] =
  {"ESPLANADE", "AVENUE", "CRESCENT", "BOULEVARDE", "BOULEVARD", "STRAND", "ENTRANCE ROAD", "PARADE", "HORSLEY DRIVE",
   "PARKWAY", "PROMENADE", "TERRACE", "CORSO", "GRAND PARADE", "GROVE", "NORTHERN ROAD", "LAKES WAY", "BUCKETTS WAY", "RIDGE",
   "GRANGE", "RIDGEWAY", "RIVER ROAD", "WOOL ROAD", "PENINSULA", "SCENIC ROAD", "TRONGATE", "ROUND DRIVE", "CREST", "CAUSEWAY",
   "FAIRWAY", "MALL", "CIRCLE", "CIRCUS", "ANCHORAGE", "CIRCUIT", "MEWS", "GLEN", "OUTLOOK", "PARK DRIVE",
   "GLADE", "GATEWAY", "DRIVE", "RISE", "QUARTERDECK", "BROADWAY", "LAKES BOULEVARD", "SPRINGS ROAD", "COMENARRA PARKWAY", "HEIGHTS",
   "CLOSE", "GLEN ROAD", "ESCORT WAY", "PIAZZA", "ELMS BOULEVARD", "LANE", "KINGSWAY", "PALLADIO", "RAMBLE", "EYRIE",
   "COVE ROAD", "PANORAMA", "CONCOURSE", "GOLDEN WAY", "PONDS BOULEVARD", "LAKE CIRCUIT", "RAMPART", "LOOP", "SUMMERLAND WAY", "CROSSING",
   "RIGHI", "LAKES DRIVE", "COVE", "DRESS CIRCLE", "SOUTHERN PARKWAY", "GREENWAY", "POINT DRIVE", "DRIFTWAY", "VISTAS DRIVE", "SERPENTINE",
   "RIDGE ROAD", "CROSSWAY", "BULWARK", "SANCTUARY", "POINT ROAD", "APPIAN WAY", "KRAAL DRIVE", "OUTBACK HIGHWAY", "SOLDIERS ROAD", "INLET DRIVE",
   "ROCK-COLLINGULLIE ROAD", "SNOWY RIVER WAY", "COMMON", "PINNACLE", "POINT", "GAP ROAD", "WALK", "PARAPET", "VALLEY AVENUE", "HIGHWAY",
   "BOGAN WAY", "BROADWATERS", "CHASE ROAD", "BASTION", "POCKET ROAD", "GROVE WAY", "RUINS WAY", "COCKLESHELL", "HALYARD", "COURT",
   "CHASE", "LINKS", "SOVEREIGN MILE", "BASIN ROAD", "KNOLL", "RETREAT", "ARCADE", "HAVEN", "WOODS CIRCUIT", "PALLADIAN DRIVE",
   "SANCTUARY DRIVE", "BOARDWALK", "COVE CRESCENT", "JIB", "CITADEL", "DOMAIN", "OLD STOCK RUN", "INLET", "GLADES", "POINT CIRCUIT",
   "BRIDLE TRACK", "HERMITAGE", "STRAIGHT", "LOOKOUT", "GALLEY", "SUMMIT ROAD", "MAINBRACE", "OVAL DRIVE", "CENTRE", "NOOK",
   "GABLES", "GARDENWAY", "GULLY ROAD", "CENTREWAY", "PLATEAU", "PROMONTORY", "BROADVIEW", "BATTLEMENT", "MARINA", "RANGE BOULEVARD",
   "VINES DRIVE", "ESTUARY", "OAKS", "PROMONTORY DRIVE", "ADDRESS", "OAKS ROAD", "PLAZA", "MAINSAIL", "HELM", "MANSE ROAD",
   "ANNIE WATT CIRCUIT", "CASCADES", "CONCORD", "EMBANKMENT", "HERMITAGE WAY", "VALE", "INLET ROAD", "PEAK ROAD", "TRIANGLE", "BITTERN BOULEVARD",
   "FORESHORE", "BOULDERS ROAD", "ELMS", "FAIRWAYS", "PASSAGE", "AGORA", "DRIVEWAY", "LANES", "LINK", "PARK CHASE",
   "PASS", "BACKWATER", "HEIGHTS BOULEVARD", "NARROWS ROAD", "BILLABONG", "CARRIAGEWAY", "BREAKWATER", "ENTRANCE", "HIGH ROAD", "JACK",
   "OAKS PARADE", "WATERMARK", "BARTIZAN", "COTTELL WAY", "REGENCY", "ACRES WAY", "LEE", "ASPECT", "HEIGHTS ROAD", "OLD OAKS ROAD",
   "PALISADE", "PROMINADE", "STRAIGHT ROAD", "TOR WALK", "BOOMERANG", "LANDINGS", "SADDLE", "SKYLINE", "PARK", "CATTLE TRACK",
   "GLENN", "GRANDSTAND", "VISTA", "SNAKE TRACK", "TROSSACHS", "BEND", "BRIARS", "COVE DRIVE", "GARDENS ROAD", "VAUCLUSE",
   "MAINDECK", "MOUNTAIN WAY", "VALLEY WAY", "WEIR ROAD", "BOWSPRIT", "CIRCLET", "COBB AND CO WAY", "RIDGE WAY", "VILLAGE AVENUE", "WAVES",
   "CUTTING", "COMPANIONWAY", "GLEN CRESCENT", "IRONS DRIVE", "MCGRANE WAY", "OVAL", "ROAD", "SPINNAKER", "HAWTHORNS", "WILLOWS",
   "ENCLAVE", "SPUR", "SUMMIT", "VILLAGE", "DEVIATION", "OUTLOOK ROAD", "QUADRANT", "RINGERS ROAD", "TILLER", "BOOM",
   "QUARTER DECK", "WALKWAY", "BULKHEAD", "ESCARPMENT", "GARDEN WALK", "GREEN", "GUMS", "OLD ROAD", "PATCH ROAD", "QUAY",
   "RETURN", "BLUFF ROAD", "BROADWATER", "CEDARS AVENUE", "CLEARWATER", "HILL", "PINERY", "SCARP", "BRANCH LANE", "ESCARPMENTS",
   "GRANGE ROAD", "MEADOWS", "SPRINGS CLOSE", "BLOCKS", "CHANNON ROAD", "LANDING", "ROCKS ROAD", "BARRACKS", "LODGE", "LOOKDOWN ROAD",
   "PULPIT", "ARCHES", "BEAM", "BIRCHES", "FOREST ROAD", "GARLANDS", "GREAT EASTERN WAY", "SEEKERS CRESCENT", "VINTAGE", "BARONS DRIVE",
   "BEACONS", "BRENTWOODS", "FOREDECK", "PINES GROVE", "BOUNTY", "COTTAGE WAY", "DELL", "LINKS ROAD", "PARKWAY PLACE", "QUADRANGLE",
   "SANCTUARY CLOSE", "SEVEN WAYS", "CLOISTERS", "CORNICHE", "CROFT", "HEATH", "SADDLE ROAD", "WELKIN TRAIL", "YARDARM", "BRIDGE",
   "CORONADO", "CROFTS", "GALLERY", "GIPPS WAY", "POSTERN", "ROCKS BOULEVARD", "SANDS", "ESTATE", "FALLS ROAD", "HORSESHOE",
   "LIDO", "ROCK MANGOPLAH ROAD", "UPPER SANCTUARY DRIVE", "GOOSE WALK", "RAMEO", "RIVERS EDGE", "WALLABY RUN", "WOODLAND", "WRIDGEWAY", "ARENA",
   "BOWERY", "HORIZON", "IRONBARKS", "OVERFLOW", "PATIO", "PINES", "PINES OUTLOOK", "QUAYS", "RIALTO", "VINEYARD",
   "GRAND", "STRAND WEST", "VALLEY ROAD", "WATER COURSE", "WOOL TRACK", "BARBETTE", "BINNACLE", "LANTERNS", "PROVENCE", "VERGE",
   "VILLAGE WAY", "BREEZEWATER", "MOOR", "PARKVIEW", "PEAK", "SHELF ROAD", "SHORES WAY", "BRIDGEWAY", "FRED HOLLOWS WAY", "GETAWAY",
   "LOCALE", "WATER LANE", "BALCONY", "LINKWAY", "MOUNTAIN WAY ROW", "REACH COURT", "STRAITS", "TRACK", "TUNNELL ROAD", "WELCOME ROAD",
   "WOOL LANE", "CEDUS", "DALES CRESCENT", "HATCH ROAD", "JETTY", "LAMBETH WALK", "VILLAGE PLACE", "WATERS", "CAMELS HUMP ROAD", "CULDESAC",
   "CUPS DRIVE", "FARM WAY", "LIMITS ROAD", "MORES", "OTWAY VISTA", "WATERWAYS BOULEVARD", "WHITEWATER", "ZENITH", "BURCHETT", "CROWSNEST",
   "DECKS", "ESPERENCE", "GRANARY", "KNOLL CRESCENT", "MEADOW", "OTWAY", "PONDS WAY", "RIVERSIDE", "WATCHTOWER", "YACHTSMANS DRIVE",
   "BELFRY", "BEND ROAD", "CAPSTAN", "GRAND CIRCUIT", "ROCK COLLINGULLIE ROAD", "SNOWY WAY", "VINES COURT", "WHARF", "WHEELHOUSE", "CEDARS CLOSE",
   "GROVE STREET", "GULLIES ROAD", "HIGHWATER", "MOUNT DRIVE", "PAINTERS ROAD", "PINES AVENUE", "PINES CLOSE", "WATERFRONT", "ATRIUM", "BARBICAN",
   "BLUFF COURT", "COOMBE", "CRITERION", "ISLAND COURT", "MEARS", "OLD NORTHERN ROAD", "POINTE", "RANGE", "SANDS WAY", "BROOK DRIVE",
   "BROW", "BULLOCK TRACK", "CEDARS DRIVE", "CORONET", "CREST COVE", "CUT LINE", "HAVEN DRIVE", "LAIRIDGE", "MERIDIAN", "MIDWAY",
   "RIVULET", "ROBBINS", "ROCK-NARRANDERA ROAD", "BURLINGS", "DOG FENCE ROAD", "FELL", "HIGH TOR", "PARKS", "PAVILION", "PONDS",
   "REEF ROAD", "RIVERWALK", "ROCK NARRANDERA ROAD", "SHUNTOFF", "CENTRE WAY", "CLUMP ROAD", "EXPRESSWAY", "FARM LANE", "GREY GUMS", "PIER",
   "PINES COURT", "PRIORY", "SHEEDY WAY", "STRAND EAST", "VINES", "BALLABOURNEEN", "BRIDLE PATH", "CRESTWAY", "DEN ROAD", "DIP ROAD",
   "FIELDS", "ISLAND ROAD", "ISLE", "LINKS DRIVE", "MARLOWS", "OUTPOST", "PANNICLE", "PORTICO", "TAFFRAIL", "WOODS BOULEVARD",
   "WOODS CLOSE", "ALBENS DRIVE", "BOLTONS", "COPSE", "DELL RETREAT", "RAPIDS", "SILHOUETTE", "STEAD", "STOCKYARD", "CREEK APPROACH",
   "CUT", "EAGLES NEST", "ELBOW", "FRESHWATER", "GUMS COURT", "HABITAT", "HILL COURT", "LAXTON", "MEAD", "MOORINGS",
   "MOUNTAIN ROAD", "QUARRY", "SHEILING", "SPIT", "BLOODWOODS ROAD", "CROSS ROAD", "CROSSOVER", "DESERT", "DUNES", "FLAT",
   "HOLLIES", "LINK ROAD", "SIDELING", "VINEYARDS ROAD", "BARRICADE", "BOLLARD", "CALLISTER", "CIRCLE ROAD", "COTSWOLDS", "DALE",
   "DOVECOTE", "EAGLES NEST ROAD", "GALLEON", "LOCH", "LOOK", "PASS ROAD", "REDOUBT", "RIALTO WEST", "ROPE WALK", "SAND TRAP",
   "SELECTION", "SEMI CIRCLE", "VILLAGE GREEN", "YACHTSMANS DRIVE", "BEATEN TRACK", "COIGN", "GANGWAY", "HOLLOW ROAD", "HOMESTEAD", "OAKS AVENUE",
   "OLD FORD", "TUNNEL ROAD", "WHIM ROAD", "BARRACKS CLOSE", "COAST ROAD", "CREEL", "DAIRY", "DECK", "DOWNS", "GRUB ROAD",
   "LAKELANDS", "LAKES", "LAWRENCE LANE", "LINE ROAD", "OLD COACH ROAD", "PINT POT", "PORT HOLE", "SILO", "TROFFS ROAD", "VINTAGE WAY",
   "WELL", "BLUFF", "BRAES ROAD", "BRIGANTINE", "BUNKER", "COURTYARD", "EAGLES PLACE", "FARM ROAD", "KEEP", "LAKELANDS ROAD",
   "LINKS COURT", "LOUGH COURT", "MAPLES", "MOUNT", "OLIVE GROVE", "PACK TRACK", "PINES ROAD", "RESERVE", "SHORT RUN", "SLIPWAY",
   "SPRINGS AVENUE", "TURKEY ROAD", "ABBEY PLACE", "ARK AVENUE", "BARB", "BASIN", "BOARD WALK", "BOULEVARDS", "BOWER", "BREAKERS ROAD",
   "BUCHAN BYPASS ROAD", "CEDARS", "CORAL GROVE", "CORKSCREW", "CRESCENT ROAD", "CROFT WAY", "CROSSING ROAD", "DESERT ROAD", "GREEN LANE", "GUNBARREL ROAD",
   "HATCH", "HEADS", "LAKES ESPLANADE", "LITTLE TERRACE", "MILL", "MILLSTREAM", "NUGGETT ROAD", "PIPPIN", "PLACE", "RING ROAD",
   "ROYAL PLACE", "TOP DECK STREET", "WHITTON", "WINDING WAY", "ANCHORAGE LANE", "BEACHWAY", "CHANCERY", "COACH ROAD", "CRATER ROAD", "CURLEW",
   "DENE", "GAP", "HEART ARCADE", "OLD CROSSING", "ORANGE ROAD", "PINES LANE", "RANGE ROAD", "SHEEP TRACK", "SIDING", "SPINNEY",
   "SPRINGS", "TRUMP CLOSE", "BOREEN", "CEDARS ROAD", "CRESCENT DRIVE", "DEEP SCHOOL ROAD", "DEPOT ROAD", "GEORGIAN ROAD", "GRASS COUNTRY ROAD", "ISLAND LANE",
   "PEAKS TERRACE", "PERCH", "PINCH LANE", "POOLWAY", "RANCH ROAD", "REST", "RUN WAY", "STABLES LANE", "TOR", "WATER WAY",
   "WATTLES ROAD", "WILLOWS ROAD", "BLOCKS ROAD", "BRIDGES ROAD", "COBBLESTONES", "DANUBE", "DRAWBRIDGE", "GLUT ROAD", "GOAT TRACK", "GRANGE LANE",
   "LAIRDS WAY", "LANEWAY", "MAJORS ROAD", "MASTERS ENCLAVE", "MINERS WAY", "PINES BOULEVARD", "PORTAL", "RAND", "RIDGE TRACK", "RIDGES ROAD",
   "YARDS ROAD", "AVENUE ROAD", "BREEZEWAY", "BROTHERS ROAD", "CELLARS", "CONDUIT", "DETOUR", "ELMS LANE", "FIVES ROAD", "FLAGS ROAD",
   "GORGE LOOP ROAD", "HALL ROAD", "HUMPS ROAD", "JUNGLE ROAD", "MILL ROAD", "MINE ROAD", "NORTHERN PARKWAY", "OAKS STATION ROAD", "OLD BRUNSWICK ROAD", "OUTPOST ROAD",
   "PADDOCK ROAD", "RANGES ROAD", "REST ROAD", "ROCK ROAD", "SANDY LANE", "SCHOOL MALL", "TWINS ROAD", "VALLEY LANE", "VIEW", "VILLAGE LANE",
   "W E MIDDLETON MEMORIAL DRIVE", "WANDERER", "WARRA WILLOWS ROAD"};

// HashStreetName of the above (including the 'THE'), note that the YACHTSMAN'S DRIVE does include the apostrophe
const int H_THE_XXX[N_THE_XXXS] =
  {1085685817, -757960720, 224584167, -1249983575, 92272236, -1123822046, 575376416, -1400317025, 813127430,
   1033948411, 1602809527, 319347146, 1545756190, -715139359, 1541060117, 31476242, -1932341501, 248666970, 1526032961,
   -684704540, -1390932018, 392385886, -593839169, -1784338325, 501563413, 119122956, -779601710, 1545797679, 154410194,
   -1673740849, -1255286352, -518090642, -518090431, -1688594010, 82885871, -1255282928, -1254795620, 1649072853, 645321016,
   1541421335, -463568988, 1532898448, -1255261263, -1193521183, -338694071, 1523517980, 511093446, -1616615631, -1688140528,
   1545892458, 1212101636, 286378063, -1410458395, -806285541, -1255320038, 438827691, -1238462066, -1171223447, 1533859614,
   1412705115, -1310254605, -2005922685, 15867672, -1877021910, -839462356, 5101557, -1255309856, 279974373, 136259746,
   1526029921, 192249760, -1254664029, 185989597, 1834594711, 1840998056, -1870255524, 502683294, -56291078, -634068779,
   1412161529, 136266701, -1583133368, 1389811944, 853619752, -424332012, 1779728837, -1557075848, -1305126787, -1892313526,
   -2094335095, -702443371, -528709135, 1850461550, 1518861680, 1615155442, -1255362963, 1034165055, -533109989, -1226318947,
   1180966742, 288237312, 1509523768, -818110128, 2061366338, -1750010854, 2052610016, 1675037167, -1531835113, 1545759523,
   1546020960, 1524382159, 1355211913, -474409869, 1537035094, -118132451, -753552308, 1528820744, -2109748433, 1525056738,
   850068420, -2139173929, 782299480, -2120437379, 84890286, -938196772, -1479790766, 1530205670, -672703580, 2033018531,
   576028775, -1487449936, 223299482, -2027890763, -664501370, -492909857, 583075520, -1474857948, -512940297, -1255102919,
   -664577726, -1786596856, 1477130127, 464088504, 506015268, 1283642061, 1708112139, -220631516, -1208011548, 64749075,
   -494840393, -132699263, -1255075126, -1062410143, 1154351722, 1913063826, 1518887770, -373520576, -1255180592, -1929494960,
   411899604, 370259741, -266087100, 430633152, 786403071, -1255396862, -1227919106, -832338853, -118925390, -911587522,
   1029837249, 1761626672, -1255006517, 601126908, 1037159854, 1539224486, 521049343, 1524111625, -1255311844, 654396808,
   -1255463571, 930650498, 1112180608, 845774656, -350834062, 1381456411, 447861782, -1135152008, 169984106, -1254965569,
   200207145, -889109188, -1041589243, -1427618374, -140262019, -728917547, -2120448272, -758659828, -1317113592, 1497283253,
   -1243808709, 1598353595, -1098295998, 2053429252, -1837809780, -1717041656, -1134126489, 714612659, -1255463660, -854789384,
   1541417554, 927704334, 1521307365, 873606241, -1017398836, -1254682415, -571972827, -632453617, 727954860, -1569985902,
   -372979586, 32588536, -1329035528, 1580956333, 1763810826, 82878074, 611815352, 1344296910, 308228364, 1522714506,
   -337924246, -932863835, -1489341305, -751522759, 2097353762, -1255089656, -1255272348, 52667915, 560080862, 62968905,
   501406410, -1255205608, -1120004185, -1154985344, 2036130623, -745464083, -1041101420, 625923218, -1566433802, -1254697037,
   -769482751, 357761890, -708848988, -548853704, -107872586, 1541062119, -1254801392, -662048029, -339336182, -1255417280,
   -1174941226, 1339731007, 529336563, -392390542, 1482584016, -1255168291, -1410230587, 1527229103, 2147311342, -932302997,
   -600791492, -1035796454, -289261816, -559748602, -998780465, 1900226299, -330919230, -1029580987, 1524460185, -1198050767,
   -1386753032, -753562190, -1254682249, -1125786888, -153105891, 1498331932, 378111980, 1180156763, -1151890406, 249803955,
   -949168501, -363361773, 551545643, 587285940, -566246809, 1882811548, -1255028899, 1524887735, 473731872, 111903694,
   843497662, 853342411, -391390026, -1268781621, 1545794832, 1528695148, -1727855201, 1299608780, 510202732, -571972157,
   -1272449495, -528378045, -453708428, 317392046, 489303101, 1271219850, 1527423735, -915053714, -1076099600, 1068055246,
   -1255311534, 1434668206, -1145275322, -259466948, 1526314888, 1062416022, 874902713, -526107192, -628507239, 1538973061,
   -566324440, -1478769989, 1508830863, 774269856, 1519369887, 1519072029, -1852592844, 1520902675, -1180268559, 622511910,
   1541057666, -736997481, -908320305, 1923938676, 1879547400, -1048677009, -2012400452, -1735580959, -1538194966, 1521744223,
   -467630065, 1393687814, -1255276157, -239466503, -1255468637, -125390448, 301296291, 750158604, -431972278, -316371036,
   -1232381644, 620787983, -810324664, -2100174605, 1312235122, 223510238, 1568573542, 1515081843, 664458784, 968460414,
   -594061695, 1546277656, -1033669256, -1455168750, 1535655594, -1435587562, 1844283483, -1289817606, 1070653777, 813561654,
   2103413189, 266826955, 2077816802, 1525559002, -342356623, -862902075, 1650593262, -1488231336, 142789783, 357911242,
   1533732806, 1562456512, -1120410740, -1437021939, -1202742487, 1531661736, 470412213, -1422684163, -51305554, -1259244779,
   -549617894, -952462231, 403333734, 1963107985, 1017207780, -1564621841, -502539772, 1522303574, -211446389, -790056408,
   1238701908, -1431402839, 273483815, -243862883, 1271922466, 2127229809, 592397003, 737792296, -764528438, -1048843126,
   1245980376, -528498539, 2127478831, -993238146, 1525359348, -101989835, -1417172171, 1526313923, 1427204280, -638901685,
   -1254703180, -1472395133, -798454318, -298859982, -636961776, 1638486672, 796003876, -2002644059, -393756851, -1198040621,
   -281878855, -677577995, -1466248562, 132783814, -994777693, -1254817761, -1816954373, 1519372231, -397319178, 1518865018,
   799315376, -1422836105, -619266013, 1164043271, -1860834120, 496191427, -1220653047, 214962018, 985697817, -1255473102,
   592331650, -1385648525, -434184235, -737355839, 1521308443, -1375843340, 407783493, 224261216, -21847669, 1426743641,
   -710500627, -1981747687, -1255162321, -1234167581, -1209435067, 1648092874, -1310175634, 486038976, 622897087, -896997460,
   -1062805078, -1111700921, -1482186053, 1545758358, -160612036, -1170328959, -1043373896, 1527769787, 421753042, -1831583312,
   -2120428546, -1919824439, 1534453103, -145272797, -1223877937, -1537684545, 76940994, -1244547780, -1255282223, -1217878128,
   1075600847, -1349803200, 532818183, -1255205246, -2067746930, -1908979654, 201558700, -926996627, 1533141909, -1254827037,
   -1457137788, 2109145988, 142030187, -1827943411, 374081237, -1481901146, 1912053991, 686980214, 264134324, -1255033008,
   -469661191, -1271171983, -453708322, -1255309452, -1255309829, -145415979, -136970941, -837356828, 1338784005, 1292410163,
   -1248634884, -1857767076, 1833671323, 662816914, 1196060106, 1545780880, -460881028, 870812507, 19304308, -218860410,
   -661338748, -876255252, -933093121, 278808723, -1317030066, 1545797345, 1533573691, -1255028491, 1533352445, -24372026,
   -1927666645, 1524110732, -484253377, 1717539530, -1608278011, 1877995348, 898104139, -1255227675, -2078407426, 1982232085,
   -1255358866, 1544824391, -863031357, -16074853, -568508295, 805966925, 1077442174, 215323740, -1254935929, 768288723,
   -1233782192, 534706842, -1208215206, 1525557681, 1757680492, -2054831254, -503332827, -125756260, 769389127, 654980021,
   -1036842542, 1901907424, -1170746950, 464171720, -1254678449, 1545278475, -2004203529, -1249983553, 1544644945, -1231243905,
   -444497059, -512424066, 1246925926, 834437657, -1336410849, -272012641, -1180517830, 297427669, -804154783, -96344430,
   1528822858, 1528695655, 1440037193, -1602445850, -1255278152, 1334653220, 1136326682, -1409752734, 1518886823, 1339142678,
   -1651380274, -1605667265, -59251093, -692143577, -1783797952, -1258122146, -318807115, 1696954818, 246394967, -531179578,
   -1255028970, -2120432278, -292601722, -336830427, 1969751604, -503110117, 1853892923, 778834616, -1143612446, 1731444586,
   1724841118, 15056868, -566286739, -1976807066, -1177637173, 705782980, -1130830962, -1468529126, -1685563656, -1982109593,
   1199042086, 1519228752, 224432870, 484591439, 1489500690, -1255256916, 481142074, 848574852, -2120457291, -892214650,
   -1454668792, -1991079183, 997263710, -1179978456, -708370423, -931432635, 1813364195, -1880423986, -469443378, -601161534,
   1254959730, 1900189749, 588167468, 2054681285, 1560983101, -703668275, -1416927576, -1255253307, -646370802, -1214697046,
   -633454887, -2145962328, 1744508028, 1548820675, 260650234, -266190382, -927172127, -1772826611, 38343275, 1469434971,
   -236373632, -868136211, 1218071, 795841467, 2027952736, 827515659, -631335347, -1521808440, 851092813, 1526095250,
   1042408402, 1040106280, -115355660, -695434479, 88306107, 1189951492, 541069331, -907392975, -1255405199, 1747683750,
   -1669419002, -1322141600, 1761039046};

// Hash but with the H excluded (and the apostrophe)
const int H__XXXs[N_THE_XXXS] =
{1588178048, -1758728215, 1252464830, -1569467984, -1349064875, -938030917, 1333086233, -960240442, -1147152641,
 -1622790142, 1751548046, 1958048435, 213735591, 945281400, 209244460, 1467899435, -1237547142, -1808058045, 229273336,
 -1685470979, 1648524759, -1984052025, -704543738, 421512914, -665566228, 1292459285, -1704172821, 213964566, -2101571765,
 213585206, 2088810601, -1534262537, -1534262888, -403680225, 908931478, 2088815369, 2088750469, -2090585428, -1113901407,
 209293102, -272888739, 208333225, 2089355752, 333238680, 20326992, 1136228005, 1208265631, -1010932792, 786650985,
 213747795, -1987122243, 1996680470, -950098820, 413076930, 2088983683, 1922917106, -1174308713, -1033088016, 202632615,
 -1104034334, -1245101270, -1979964358, -1543457215, -1721043181, 1022066933, 267473932, 2088985913, 88456316, 1791439483,
 229276120, 943528345, 2088885370, -1081275516, -1529170546, -1387527439, -704815003, 761566215, 957301283, 936293900,
 -9464160, 1791436884, 1556565297, -1056045103, 499859825, -1949703731, 1880300284, 259781825, -2010538556, 827381107,
 -1316262384, 2082478316, -1537595672, -111128905, 231570121, -523482133, 2089309748, -1623141946, -1435491038, 632738020,
 -976181073, 347064953, 840382177, 1095142313, 2050026939, 1367692131, -1613713383, -290945130, 937831662, 213732634,
 213893721, 216714614, 1163680272, 517162154, 222469743, 91843044, -1754338411, 221746097, -1057315242, 1212554459,
 880037757, -81898770, 174093921, 193455108, 901773783, -1721495931, 166397291, 215634527, -1683262275, 877532506,
 -1588620354, -1294905975, 686449411, 152502732, -1700516385, -234338138, 291072505, 1479267133, -1548625426, 2088914272,
 -1700854373, 1246251825, -1978518890, 1234371073, -1407940003, -2112343148, 670676274, 1155070525, -1617287043, 803477290,
 303174798, 1548394104, 2089021651, 1570029496, 1533671315, -2043050965, 231400291, -1161940007, 2089123145, -345954615,
 -1194282547, -1847809660, 806692413, 2064360857, 776916870, 2089204123, 1195792167, -2106549662, 1378845419, -370253753,
 -1617596936, 772987273, 2088539090, -1541622875, -1621401641, 206607263, 743060902, 216984752, 2088975493, -1108898479,
 2089414580, 564676283, 871993337, 934498585, 123305547, 2007366754, 2081747535, 1728845345, 1803775955, 2089060070,
 129099088, 2040924677, 1736445724, -1476091005, 113427972, 671276460, 193453193, -1748956331, -592965039, 129840204,
 -1178575390, 1764916866, 1053344379, 871978333, 1755517237, -1880985071, -918366082, 120380490, 2089414541, -732106335,
 209288811, -511569961, 224520284, -230199976, 962181237, 2088768584, -1636790852, -2052525354, -1318409163, 950923531,
 -1162476889, -2014089951, 1992978401, -927250924, 1092411283, 908943747, 539066497, -1431937097, -645842155, 227721011,
 1030467091, -700345604, -898006594, -1001591424, 1344812059, 2089040401, 2089353917, 1553714098, 1882864103, -799147984,
 1208536883, 2089439233, -941566018, -300443783, -2037179898, 1928689140, -604558195, 1237561419, -1106792337, 2088778986,
 -1930403880, -1093805797, -158283523, 1970760737, 96732239, 209230046, 2088756233, -1112519942, 1838887827, 2089220185,
 -1038426865, 1559654, 661269738, 1249641291, -562808439, 2089119044, -950605540, 232541846, 1902150423, 610594834,
 1742858821, -1692092061, 1197722353, -1653610785, -1003101162, 73150978, -364276773, 1747860060, 217054496, -1172880888,
 -982868895, -1754328661, 2088768174, 1407849601, 341264740, -473231227, 414271061, 1970620162, -299073821, 668340586,
 918017266, 589024330, -308493966, 1560626573, -1651712258, -1474216667, 2088700868, -242952594, 1368792793, -1233862121,
 877391623, -1987252782, -1491020529, 1634644178, 213980201, 221593045, -532364698, -1546085035, -1808951275, -1636791398,
 1628824816, -1528588006, -282466291, -293416361, -1239429820, -45024205, 232482510, -1905349385, 1350942505, 1525879671,
 2088975307, 331125719, -1389631745, 1729003237, 228995505, -556759569, -1085750272, -1721339951, 1578827808, 207141564,
 -1651495887, 724047682, 739791286, 799592057, 231200806, 231494820, 614425677, 224789290, -1023751320, -1259703809,
 209226171, -2077928978, 1343873334, 852719213, -1781106351, 1766681142, -1867884059, -1862166856, -307680589, 224374758,
 -693571402, 940594687, 2088812698, -2012580576, 2089410810, 2018752137, -68014534, -1795433035, -1857676845, -125690787,
 -1427167699, -1497740138, 1078173489, -220988918, 4851627, 1672362343, -890252897, 226149834, -1553258183, -711934489,
 -704452040, 213362081, 1370535585, -1340246901, 219379987, -1151121713, 613606562, -1075208861, 1339529096, 565794671,
 -715404132, -1193810478, -1711994341, 211355747, 356621640, -1650634372, 1274312823, -724993151, -1166446834, -855685261,
 207646975, 1405816185, 214034165, 1367136148, -1613081808, 219048337, -598095156, 1762328900, 1540535223, 897836300,
 -1663745853, -1647793584, 592935583, -243641240, 1328581949, -2017663850, 292613693, 228123759, 2070528594, 2122143089,
 -722814195, -1419940688, 1856944030, 1152927652, -1485687141, -112791448, 1564851186, -1377847631, -1757174381, 1767121811,
 71542625, -1537384372, 951173270, -1973441113, 211420621, 139805516, -948120660, 228996730, -943800255, -1795384590,
 2088793325, 616113658, 2116728779, 830261579, -1080591223, -330855991, 329768093, -1898834820, 581274452, -1627110390,
 554310976, 498941964, 1617689943, -1160770081, -435222470, 2088633222, -596082398, 231203198, 2123130671, 231566531,
 900000009, 1762193870, -100020550, 1192831006, 2075573025, -1076723494, -511671216, -740790437, 1245876384, 2089423723,
 1564768443, -970173718, -1891665908, -2077139656, 224531362, 1704987853, -2130712260, 1253057977, 2076224082, -957356032,
 -1806314892, -1622215584, 2088977910, 583610842, -1830560196, -2089875789, -1245459017, -1240482375, 78778726, -774038763,
 -379929837, -1558190242, 1299241154, 213729327, 779309541, -1033830696, 964003745, 231865986, -1853234325, -824520727,
 193450247, 977962416, 202326486, -891419078, -323241322, 948699206, 1360232859, -1428949083, 2088815048, 1503371273,
 -2040354826, -1171891559, 1810674462, 2089439131, -2116711305, 1014661091, -1011858283, -1737025676, 208225068, 2088642874,
 725558909, -267404611, -1932933326, -1621987052, 1854278892, 1298935263, -564792866, 1900002319, -522223347, 2088696777,
 -1426320992, 252388712, -282466649, 2088985773, 2088985890, -590262292, 110411578, 649031837, 16291132, -967982710,
 -794642363, 1530019109, 633405794, 897836300, -104102317, 213702825, -279897851, -366258014, 1431502669, 548457983,
 -1112959395, 865974677, 411017286, -187531958, -1505132457, 213965272, 207514242, 2088700716, 208154180, -1882483585,
 -1253996654, 216981685, 131072774, -32600845, -885985316, -138244531, 2004026738, 2089461436, -1164198137, 475530412,
 2089313847, 210215550, -923518886, 296976450, -1644703264, -1774093708, -2099283673, -740742811, 2089161374, 1698337866,
 592573033, 942092579, -1617210493, 211357064, 126645973, -761519373, -82192644, 90000869, 276592702, 23492684,
 808528075, -1120783463, 1953347587, -678300463, 2088773078, 210036018, 1505017518, -1569467994, 210255720, -2074053818,
 1902494788, -1548997913, 100825183, 2036865696, -1075893850, -232522010, 35134467, 765791916, 797520952, -1650907125,
 221748211, 221592542, -2001651344, -402756865, 2088802401, 1546396349, -1828168637, -950669317, 231400990, -700510673,
 -602601225, -1403703418, -690731886, 1865928734, -1788012583, 229586887, -1324610836, -537215781, -1963449298, -1530656737,
 2088700815, 193445523, 3839455, 1573511612, -827684275, -82833278, -1776394270, -124212863, -908896901, -740036973,
 -733446041, 1785370589, -1651664140, -455678433, -1123881070, 704024861, 758986007, 1274536227, 2119268577, -1621984738,
 202054751, 231059177, -1694510401, -1225784138, 1606176395, 2089342709, -505266685, 910686173, 193462348, 2037003647,
 1660432465, 2141857768, -485704793, 552353073, 1252303120, -1741929060, -1850778886, 1261666423, 473852951, 1743081403,
 -2095187093, 73200204, 1339709653, -1743180676, -1599451612, -526581260, -948643791, 2089347676, -304512585, -1937817261,
 835893184, 1822685905, 71854917, 1175329018, 431892355, 806665131, -1737111944, 2085703092, 1777542194, 1602579394,
 -1463679047, -1300872236, -774532466, 669249858, -1056116135, 1014946482, -264227628, -673227023, -821226604, -1549166773,
 542211723, 436392145, -15351987, -1133118936, -1472100510, 81631741, -1388107894, 1343093960, 2089212584, -1412631105,
 2049820511, -1653320775, -1602686049};

// Some localities also contain 'THE'
// THE LOCALITIES are the indices of THE_XXXs which are also street names
// in Australia
#define N_THE_LOCALITIES 22
const int THE_LOCALITIES[N_THE_LOCALITIES] =
  {20, 36, 92, 130, 151, 186, 207, 241, 255, 264,
   334, 353, 426, 448, 463, 502, 550, 560, 584, 599,
   620, 629};

SEXP C_getTHEXXX(SEXP x) {
  errifNotTF(x, "x");
  const bool x_ = asLogical(x);
  if (x_) {
    SEXP ans = PROTECT(allocVector(STRSXP, N_THE_XXXS));
    for (int i = 0; i < N_THE_XXXS; ++i) {
      SET_STRING_ELT(ans, i, mkCharCE(THE_XXXs[i], CE_UTF8));
    }
    UNPROTECT(1);
    return ans;
  }
  SEXP ans = PROTECT(allocVector(INTSXP, N_THE_LOCALITIES));
  for (int i = 0; i < N_THE_LOCALITIES; ++i) {
    INTEGER(ans)[i] = THE_LOCALITIES[i] + 1;
  }
  UNPROTECT(1);
  return ans;
}


#define ALPHABET_SIZE 27  // Assuming only uppercase letters plus space

typedef struct TrieNode {
  struct TrieNode *children[ALPHABET_SIZE];
  bool isEndOfWord;
  int code;  // New field to store the code
} TrieNode;


TrieNode *getNode(void) {
  TrieNode *pNode = (TrieNode *)malloc(sizeof(TrieNode));

  if (pNode) {
    pNode->isEndOfWord = false;
    for (int i = 0; i < ALPHABET_SIZE; i++) {
      pNode->children[i] = NULL;
    }
  }

  return pNode;
}

void freeTrie(TrieNode *root) {
  if (!root) return;

  for (int i = 0; i < ALPHABET_SIZE; i++) {
    freeTrie(root->children[i]);
  }

  free(root);
}

void insert(TrieNode *root, const char *key, int code) {
  TrieNode *pCrawl = root;

  for (int i = 0; key[i] != '\0'; i++) {
    unsigned int index = key[i] - 'A';
    if (index >= ALPHABET_SIZE) {
      index = ALPHABET_SIZE - 1;
    }
    if (!pCrawl->children[index]) {
      pCrawl->children[index] = getNode();
    }
    pCrawl = pCrawl->children[index];
  }

  pCrawl->isEndOfWord = true;
  pCrawl->code = code;  // Set the code for the end node
}

int search(TrieNode *root, const char *key) {
  TrieNode *pCrawl = root;

  for (int i = 0; key[i] != '\0'; i++) {
    int index = key[i] - 'A';
    if (!pCrawl->children[index]) {
      return -1;  // Word not found
    }
    pCrawl = pCrawl->children[index];
  }

  if (pCrawl != NULL && pCrawl->isEndOfWord) {
    return pCrawl->code;  // Return the code associated with the word
  }

  return -1;  // Word not found
}

void insert_all(TrieNode *root) {
  for (int i = 0; i < N_THE_XXXS; ++i) {
    insert(root, THE_XXXs[i], i + 1);
  }
}

int THE_xxx2(TrieNode *root, WordData wd) {
  const char *x = wd.x;
  int n_words = wd.n_words;

  for (int w = 0; w < n_words - 1; ++w) {
    int lhs = wd.lhs[w];
    int rhs = wd.rhs[w];

    if (rhs - lhs != 3) continue;

    int j = lhs;
    if (x[j++] != 'T' || x[j++] != 'H' || x[j++] != 'E') continue;

    lhs = wd.lhs[w + 1];
    rhs = wd.rhs[w + 1];
    int w_ = rhs - lhs;
    // ensure that the below buffer won't overflow || disregard numbers
    // both are unlikely
    if (w_ > MAX_STREET_NAME_LEN || !isupper(x[lhs])) {
      continue;
    }

    // Extract the substring starting after 'THE ' and use it for trie search
    char streetName[MAX_STREET_NAME_LEN]; // Define MAX_STREET_NAME_LEN appropriately
    strncpy(streetName, x + lhs, w_);
    streetName[w_] = '\0'; // Null-terminate the extracted string

    // Use trie to check if this is a known street name
    int maybe_code = search(root, streetName);
    if (maybe_code != -1) {
      // Found a match, return appropriate code or perform needed action
      return maybe_code; // Replace with actual return code
    }
    // There are some roads with THE XXX but where XXX is more than one word


  }

  return 0; // No match found
}

SEXP C_do_the_xxx(SEXP x) {
  errIfNotStr(x, "x");
  R_xlen_t N = xlength(x);
  const SEXP * xp = STRING_PTR(x);
  TrieNode * root = getNode();
  if (root == NULL) {
    error("root == NULL");
  }
  insert_all(root);
  SEXP ans = PROTECT(allocVector(INTSXP, N));
  int * restrict ansp = INTEGER(ans);
  for (R_xlen_t i = 0; i < N; ++i) {
    if (xp[i] == NA_STRING) {
      ansp[i] = NA_INTEGER;
      continue;
    }
    const char * xi = CHAR(xp[i]);
    int ni = length(xp[i]);
    if (ni <= 4) {
      ansp[i] = 0;
      continue;
    }
    WordData wd = word_data(xi, ni, 0); // 9M/s
    ansp[i] = THE_xxx2(root, wd); // 60M/s
  }
  freeTrie(root);
  UNPROTECT(1);
  return ans;
}

int THE_xxx3(TrieNode *root, WordData wd, int postcode) {
  const char *x = wd.x;
  int n_words = wd.n_words;

  for (int w = 0; w < n_words - 1; ++w) {
    int lhs = wd.lhs[w];
    int rhs = wd.rhs[w];

    // Check if the current word is 'THE'
    if (rhs - lhs == 3 && strncmp(x + lhs, "THE", 3) == 0) {
      char streetName[MAX_STREET_NAME_LEN] = {0}; // Buffer for street name
      int currentLength = 0; // Current length of streetName

      // Iterate over the following words to construct potential street names
      for (int i = w + 1; i < n_words; ++i) {
        int wordStart = wd.lhs[i];
        int wordEnd = wd.rhs[i];
        int wordLength = wordEnd - wordStart;

        // Check if adding the next word exceeds the buffer size
        if (currentLength + wordLength < MAX_STREET_NAME_LEN - 1) {
          // Append a space before the word if it's not the first word
          if (currentLength > 0) {
            // ++ accounts for the space in current length
            streetName[currentLength++] = ' ';
          }

          // Append the word to streetName
          strncat(streetName, x + wordStart, wordLength);
          currentLength += wordLength;

          // Use trie to check if this is a known street name
          int trie_code = search(root, streetName);
          if (trie_code != -1) {
            return trie_code;
          }
        } else {
          break; // Buffer would overflow, stop appending
        }
      }
    }
  }

  return 0; // No match found
}



